<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>scran_quality_control: scran::adt_quality_control Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">scran_quality_control
   </div>
   <div id="projectbrief">Compute simple per-cell quality control metrics</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacescran.html">scran</a></li><li class="navelem"><a class="el" href="namespacescran_1_1adt__quality__control.html">adt_quality_control</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">scran::adt_quality_control Namespace Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Simple per-cell QC metrics from an ADT count matrix.  
<a href="namespacescran_1_1adt__quality__control.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscran_1_1adt__quality__control_1_1BlockedFilters.html">BlockedFilters</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Filter for high-quality cells using ADT-based metrics with blocking.  <a href="classscran_1_1adt__quality__control_1_1BlockedFilters.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscran_1_1adt__quality__control_1_1Filters.html">Filters</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Filter for high-quality cells using ADT-based metrics.  <a href="classscran_1_1adt__quality__control_1_1Filters.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structscran_1_1adt__quality__control_1_1FiltersOptions.html">FiltersOptions</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Options for <code>Filters()</code>.  <a href="structscran_1_1adt__quality__control_1_1FiltersOptions.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structscran_1_1adt__quality__control_1_1MetricsBuffers.html">MetricsBuffers</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Buffers for direct storage of the calculated statistics.  <a href="structscran_1_1adt__quality__control_1_1MetricsBuffers.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structscran_1_1adt__quality__control_1_1MetricsOptions.html">MetricsOptions</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Options for <code><a class="el" href="namespacescran_1_1adt__quality__control.html#a16d8e4add23d4a08431fde30264ea869">compute_metrics()</a></code>.  <a href="structscran_1_1adt__quality__control_1_1MetricsOptions.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structscran_1_1adt__quality__control_1_1MetricsResults.html">MetricsResults</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Results of the QC metric calculations.  <a href="structscran_1_1adt__quality__control_1_1MetricsResults.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a16d8e4add23d4a08431fde30264ea869" id="r_a16d8e4add23d4a08431fde30264ea869"><td class="memTemplParams" colspan="2">template&lt;typename Value_ , typename Index_ , typename Subset_ , typename Sum_ , typename Detected_ &gt; </td></tr>
<tr class="memitem:a16d8e4add23d4a08431fde30264ea869"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacescran_1_1adt__quality__control.html#a16d8e4add23d4a08431fde30264ea869">compute_metrics</a> (const <a class="elRef" href="https://tatami-inc.github.io/tatami/classtatami_1_1Matrix.html">tatami::Matrix</a>&lt; Value_, Index_ &gt; *mat, const std::vector&lt; Subset_ &gt; &amp;subsets, <a class="el" href="structscran_1_1adt__quality__control_1_1MetricsBuffers.html">MetricsBuffers</a>&lt; Sum_, Detected_ &gt; &amp;output, const <a class="el" href="structscran_1_1adt__quality__control_1_1MetricsOptions.html">MetricsOptions</a> &amp;options)</td></tr>
<tr class="separator:a16d8e4add23d4a08431fde30264ea869"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a217e0138960775b917c05731ef18d246" id="r_a217e0138960775b917c05731ef18d246"><td class="memTemplParams" colspan="2">template&lt;typename Sum_  = double, typename Detected_  = int, typename Value_  = double, typename Index_  = int, typename Subset_  = const uint8_t*&gt; </td></tr>
<tr class="memitem:a217e0138960775b917c05731ef18d246"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="structscran_1_1adt__quality__control_1_1MetricsResults.html">MetricsResults</a>&lt; Sum_, Detected_ &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacescran_1_1adt__quality__control.html#a217e0138960775b917c05731ef18d246">compute_metrics</a> (const <a class="elRef" href="https://tatami-inc.github.io/tatami/classtatami_1_1Matrix.html">tatami::Matrix</a>&lt; Value_, Index_ &gt; *mat, const std::vector&lt; Subset_ &gt; &amp;subsets, const <a class="el" href="structscran_1_1adt__quality__control_1_1MetricsOptions.html">MetricsOptions</a> &amp;options)</td></tr>
<tr class="separator:a217e0138960775b917c05731ef18d246"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2ed5bbd683cbf8731f6d2557924994d" id="r_ac2ed5bbd683cbf8731f6d2557924994d"><td class="memTemplParams" colspan="2">template&lt;typename Float_  = double, typename Sum_  = double, typename Detected_  = int&gt; </td></tr>
<tr class="memitem:ac2ed5bbd683cbf8731f6d2557924994d"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="classscran_1_1adt__quality__control_1_1Filters.html">Filters</a>&lt; Float_ &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacescran_1_1adt__quality__control.html#ac2ed5bbd683cbf8731f6d2557924994d">compute_filters</a> (size_t num, const <a class="el" href="structscran_1_1adt__quality__control_1_1MetricsBuffers.html">MetricsBuffers</a>&lt; Sum_, Detected_ &gt; &amp;metrics, const <a class="el" href="structscran_1_1adt__quality__control_1_1FiltersOptions.html">FiltersOptions</a> &amp;options)</td></tr>
<tr class="separator:ac2ed5bbd683cbf8731f6d2557924994d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2934150ffb0ed08bfda09e95b48196bb" id="r_a2934150ffb0ed08bfda09e95b48196bb"><td class="memTemplParams" colspan="2">template&lt;typename Float_  = double, typename Sum_  = double, typename Detected_  = int&gt; </td></tr>
<tr class="memitem:a2934150ffb0ed08bfda09e95b48196bb"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="classscran_1_1adt__quality__control_1_1Filters.html">Filters</a>&lt; Float_ &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacescran_1_1adt__quality__control.html#a2934150ffb0ed08bfda09e95b48196bb">compute_filters</a> (const <a class="el" href="structscran_1_1adt__quality__control_1_1MetricsResults.html">MetricsResults</a>&lt; Sum_, Detected_ &gt; &amp;metrics, const <a class="el" href="structscran_1_1adt__quality__control_1_1FiltersOptions.html">FiltersOptions</a> &amp;options)</td></tr>
<tr class="separator:a2934150ffb0ed08bfda09e95b48196bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a61e264eff3efa03a66b8ee39df5d510c" id="r_a61e264eff3efa03a66b8ee39df5d510c"><td class="memTemplParams" colspan="2">template&lt;typename Float_  = double, typename Sum_  = double, typename Detected_  = int, typename Block_  = int&gt; </td></tr>
<tr class="memitem:a61e264eff3efa03a66b8ee39df5d510c"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="classscran_1_1adt__quality__control_1_1BlockedFilters.html">BlockedFilters</a>&lt; Float_ &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacescran_1_1adt__quality__control.html#a61e264eff3efa03a66b8ee39df5d510c">compute_filters_blocked</a> (size_t num, const <a class="el" href="structscran_1_1adt__quality__control_1_1MetricsBuffers.html">MetricsBuffers</a>&lt; Sum_, Detected_ &gt; &amp;metrics, const Block_ *block, const <a class="el" href="structscran_1_1adt__quality__control_1_1FiltersOptions.html">FiltersOptions</a> &amp;options)</td></tr>
<tr class="separator:a61e264eff3efa03a66b8ee39df5d510c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aded7e02913640f70dd8e8fb25959f72d" id="r_aded7e02913640f70dd8e8fb25959f72d"><td class="memTemplParams" colspan="2">template&lt;typename Float_  = double, typename Sum_  = double, typename Detected_  = int, typename Block_  = int&gt; </td></tr>
<tr class="memitem:aded7e02913640f70dd8e8fb25959f72d"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="classscran_1_1adt__quality__control_1_1BlockedFilters.html">BlockedFilters</a>&lt; Float_ &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacescran_1_1adt__quality__control.html#aded7e02913640f70dd8e8fb25959f72d">compute_filters_blocked</a> (const <a class="el" href="structscran_1_1adt__quality__control_1_1MetricsResults.html">MetricsResults</a>&lt; Sum_, Detected_ &gt; &amp;metrics, const Block_ *block, const <a class="el" href="structscran_1_1adt__quality__control_1_1FiltersOptions.html">FiltersOptions</a> &amp;options)</td></tr>
<tr class="separator:aded7e02913640f70dd8e8fb25959f72d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Simple per-cell QC metrics from an ADT count matrix. </p>
<p>Given a feature-by-cell ADT count matrix, this class computes several QC metrics:</p>
<ul>
<li>The sum of counts for each cell, which (in theory) represents the efficiency of library preparation and sequencing. This is less useful as a QC metric for ADT data given that the sum is strongly influenced by biological variation in the abundance of the targeted features. Nonetheless, we compute it for diagnostic purposes.</li>
<li>The number of detected features per cell. Even though ADTs are commonly applied in situations where few features are highly abundant, we still expect detectable coverage of most features due to ambient contamination, non-specific binding or some background expression. The absence of detectable coverage indicates that library preparation or sequencing depth was suboptimal.</li>
<li>The sum of counts in pre-defined feature subsets. While the exact interpretation depends on the nature of the subset, the most common use case involves isotype control (IgG) features. IgG antibodies should not bind to anything, so high coverage suggests that non-specific binding is a problem, e.g., due to antibody conjugates.</li>
</ul>
<p>Outliers are defined on each metric by counting the number of MADs from the median value across all cells, see <code><a class="el" href="namespacescran_1_1choose__filter__thresholds.html#ae991983721dc1e71443f6ae641f67205">choose_filter_thresholds::compute()</a></code> for details. For the number of detected features and the subset sums, the outliers are defined after log-transformation of the metrics. This improves resolution at low values, symmetrizes long right tails, and ensures that the defined threshold is not negative. Note that all thresholds are still reported on the original scale, so no further exponentiation is required.</p>
<p>For the number of detected features, we supplement the MAD-based threshold with a minimum drop. Cells are only considered to be low quality if the difference in the number of detected features from the median is greater than a certain percentage. By default, the number must drop by at least 10% from the median. This avoids overly aggressive filtering when the MAD is zero due to the discrete nature of this statistic in datasets with few tags. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a16d8e4add23d4a08431fde30264ea869" name="a16d8e4add23d4a08431fde30264ea869"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a16d8e4add23d4a08431fde30264ea869">&#9670;&#160;</a></span>compute_metrics() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Value_ , typename Index_ , typename Subset_ , typename Sum_ , typename Detected_ &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void scran::adt_quality_control::compute_metrics </td>
          <td>(</td>
          <td class="paramtype">const <a class="elRef" href="https://tatami-inc.github.io/tatami/classtatami_1_1Matrix.html">tatami::Matrix</a>&lt; Value_, Index_ &gt; *&#160;</td>
          <td class="paramname"><em>mat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; Subset_ &gt; &amp;&#160;</td>
          <td class="paramname"><em>subsets</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structscran_1_1adt__quality__control_1_1MetricsBuffers.html">MetricsBuffers</a>&lt; Sum_, Detected_ &gt; &amp;&#160;</td>
          <td class="paramname"><em>output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structscran_1_1adt__quality__control_1_1MetricsOptions.html">MetricsOptions</a> &amp;&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute the QC metrics from an input matrix. This is a wrapper around <code><a class="el" href="namespacescran_1_1per__cell__qc__metrics.html#a442874c635f37e35a72d7048246615e2">per_cell_qc_metrics::compute()</a></code> with some pre-configuration for ADT-relevant metrics.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Value_</td><td>Type of matrix value. </td></tr>
    <tr><td class="paramname">Index_</td><td>Type of the matrix indices. </td></tr>
    <tr><td class="paramname">Subset_</td><td>Either a pointer to an array of booleans or a <code>vector</code> of indices. </td></tr>
    <tr><td class="paramname">Sum_</td><td>Numeric type to store the summed expression. </td></tr>
    <tr><td class="paramname">Detected_</td><td>Integer type to store the number of cells.</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">mat</td><td>Pointer to a feature-by-cells matrix containing counts. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">subsets</td><td>Vector of feature subsets, see <code><a class="el" href="namespacescran_1_1per__cell__qc__metrics.html#a442874c635f37e35a72d7048246615e2">per_cell_qc_metrics::compute()</a></code> for details. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">output</td><td><code><a class="el" href="structscran_1_1adt__quality__control_1_1MetricsBuffers.html" title="Buffers for direct storage of the calculated statistics.">MetricsBuffers</a></code> object in which to store the output. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">options</td><td>Further options. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a217e0138960775b917c05731ef18d246" name="a217e0138960775b917c05731ef18d246"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a217e0138960775b917c05731ef18d246">&#9670;&#160;</a></span>compute_metrics() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Sum_  = double, typename Detected_  = int, typename Value_  = double, typename Index_  = int, typename Subset_  = const uint8_t*&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structscran_1_1adt__quality__control_1_1MetricsResults.html">MetricsResults</a>&lt; Sum_, Detected_ &gt; scran::adt_quality_control::compute_metrics </td>
          <td>(</td>
          <td class="paramtype">const <a class="elRef" href="https://tatami-inc.github.io/tatami/classtatami_1_1Matrix.html">tatami::Matrix</a>&lt; Value_, Index_ &gt; *&#160;</td>
          <td class="paramname"><em>mat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; Subset_ &gt; &amp;&#160;</td>
          <td class="paramname"><em>subsets</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structscran_1_1adt__quality__control_1_1MetricsOptions.html">MetricsOptions</a> &amp;&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Overload of <code><a class="el" href="namespacescran_1_1adt__quality__control.html#a16d8e4add23d4a08431fde30264ea869">compute_metrics()</a></code> that allocates memory for the results.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Sum_</td><td>Numeric type to store the summed expression. </td></tr>
    <tr><td class="paramname">Detected_</td><td>Integer type to store the number of cells. </td></tr>
    <tr><td class="paramname">Value_</td><td>Type of matrix value. </td></tr>
    <tr><td class="paramname">Index_</td><td>Type of the matrix indices. </td></tr>
    <tr><td class="paramname">Subset_</td><td>Either a pointer to an array of booleans or a <code>vector</code> of indices.</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">mat</td><td>Pointer to a feature-by-cells <b>tatami</b> matrix containing counts. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">subsets</td><td>Vector of feature subsets, see <code><a class="el" href="namespacescran_1_1per__cell__qc__metrics.html#a442874c635f37e35a72d7048246615e2">per_cell_qc_metrics::compute()</a></code> for details. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">options</td><td>Further options.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A <code>PerCellRnaQcMetrics::Results</code> object containing the QC metrics. Subset proportions are returned depending on the <code>subsets</code>. </dd></dl>

</div>
</div>
<a id="ac2ed5bbd683cbf8731f6d2557924994d" name="ac2ed5bbd683cbf8731f6d2557924994d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac2ed5bbd683cbf8731f6d2557924994d">&#9670;&#160;</a></span>compute_filters() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Float_  = double, typename Sum_  = double, typename Detected_  = int&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classscran_1_1adt__quality__control_1_1Filters.html">Filters</a>&lt; Float_ &gt; scran::adt_quality_control::compute_filters </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structscran_1_1adt__quality__control_1_1MetricsBuffers.html">MetricsBuffers</a>&lt; Sum_, Detected_ &gt; &amp;&#160;</td>
          <td class="paramname"><em>metrics</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structscran_1_1adt__quality__control_1_1FiltersOptions.html">FiltersOptions</a> &amp;&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Float_</td><td>Floating-point type for the thresholds. </td></tr>
    <tr><td class="paramname">Sum_</td><td>Numeric type to store the summed expression. </td></tr>
    <tr><td class="paramname">Detected_</td><td>Integer type to store the number of cells. </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">num</td><td>Number of cells. </td></tr>
    <tr><td class="paramname">metrics</td><td>A collection of arrays containing ADT-based QC metrics, filled by <code><a class="el" href="namespacescran_1_1adt__quality__control.html#a16d8e4add23d4a08431fde30264ea869">compute_metrics()</a></code>. <code><a class="el" href="structscran_1_1adt__quality__control_1_1MetricsBuffers.html#a541c0a789650dc135e5c759041c4a1c3">MetricsBuffers::subset_sum</a></code> is assumed to contain the sums of negative control feature subsets like IgG antibodies. </td></tr>
    <tr><td class="paramname">options</td><td>Further options for filtering. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a2934150ffb0ed08bfda09e95b48196bb" name="a2934150ffb0ed08bfda09e95b48196bb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2934150ffb0ed08bfda09e95b48196bb">&#9670;&#160;</a></span>compute_filters() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Float_  = double, typename Sum_  = double, typename Detected_  = int&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classscran_1_1adt__quality__control_1_1Filters.html">Filters</a>&lt; Float_ &gt; scran::adt_quality_control::compute_filters </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structscran_1_1adt__quality__control_1_1MetricsResults.html">MetricsResults</a>&lt; Sum_, Detected_ &gt; &amp;&#160;</td>
          <td class="paramname"><em>metrics</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structscran_1_1adt__quality__control_1_1FiltersOptions.html">FiltersOptions</a> &amp;&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Float_</td><td>Floating-point type for the thresholds. </td></tr>
    <tr><td class="paramname">Sum_</td><td>Numeric type to store the summed expression. </td></tr>
    <tr><td class="paramname">Detected_</td><td>Integer type to store the number of cells. </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">metrics</td><td>ADT-based QC metrics from <code><a class="el" href="namespacescran_1_1adt__quality__control.html#a16d8e4add23d4a08431fde30264ea869">compute_metrics()</a></code>. <code><a class="el" href="structscran_1_1adt__quality__control_1_1MetricsBuffers.html#a541c0a789650dc135e5c759041c4a1c3">MetricsBuffers::subset_sum</a></code> is assumed to contain the sums of negative control feature subsets like IgG antibodies. </td></tr>
    <tr><td class="paramname">options</td><td>Further options for filtering. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a61e264eff3efa03a66b8ee39df5d510c" name="a61e264eff3efa03a66b8ee39df5d510c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a61e264eff3efa03a66b8ee39df5d510c">&#9670;&#160;</a></span>compute_filters_blocked() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Float_  = double, typename Sum_  = double, typename Detected_  = int, typename Block_  = int&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classscran_1_1adt__quality__control_1_1BlockedFilters.html">BlockedFilters</a>&lt; Float_ &gt; scran::adt_quality_control::compute_filters_blocked </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structscran_1_1adt__quality__control_1_1MetricsBuffers.html">MetricsBuffers</a>&lt; Sum_, Detected_ &gt; &amp;&#160;</td>
          <td class="paramname"><em>metrics</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Block_ *&#160;</td>
          <td class="paramname"><em>block</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structscran_1_1adt__quality__control_1_1FiltersOptions.html">FiltersOptions</a> &amp;&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Sum_</td><td>Numeric type to store the summed expression. </td></tr>
    <tr><td class="paramname">Detected_</td><td>Integer type to store the number of cells. </td></tr>
    <tr><td class="paramname">Block_</td><td>Integer type for the block assignments. </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">num</td><td>Number of cells. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">metrics</td><td>A collection of arrays containing ADT-based QC metrics, filled by <code><a class="el" href="namespacescran_1_1adt__quality__control.html#a16d8e4add23d4a08431fde30264ea869">compute_metrics()</a></code>. <code><a class="el" href="structscran_1_1adt__quality__control_1_1MetricsBuffers.html#a541c0a789650dc135e5c759041c4a1c3">MetricsBuffers::subset_sum</a></code> is assumed to contain the sums of negative control feature subsets like IgG antibodies. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">block</td><td>Pointer to an array of length <code>num</code> containing block identifiers. Values should be integer IDs in <picture><source srcset="form_0_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$[0, N)$" src="form_0.png"/></picture> where <picture><source srcset="form_1_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$N$" src="form_1.png"/></picture> is the number of blocks. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">options</td><td>Further options for filtering. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aded7e02913640f70dd8e8fb25959f72d" name="aded7e02913640f70dd8e8fb25959f72d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aded7e02913640f70dd8e8fb25959f72d">&#9670;&#160;</a></span>compute_filters_blocked() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Float_  = double, typename Sum_  = double, typename Detected_  = int, typename Block_  = int&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classscran_1_1adt__quality__control_1_1BlockedFilters.html">BlockedFilters</a>&lt; Float_ &gt; scran::adt_quality_control::compute_filters_blocked </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structscran_1_1adt__quality__control_1_1MetricsResults.html">MetricsResults</a>&lt; Sum_, Detected_ &gt; &amp;&#160;</td>
          <td class="paramname"><em>metrics</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Block_ *&#160;</td>
          <td class="paramname"><em>block</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structscran_1_1adt__quality__control_1_1FiltersOptions.html">FiltersOptions</a> &amp;&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Sum_</td><td>Numeric type to store the summed expression. </td></tr>
    <tr><td class="paramname">Detected_</td><td>Integer type to store the number of cells. </td></tr>
    <tr><td class="paramname">Block_</td><td>Integer type for the block assignments. </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">metrics</td><td>ADT-based QC metrics computed by <code><a class="el" href="namespacescran_1_1adt__quality__control.html#a16d8e4add23d4a08431fde30264ea869">compute_metrics()</a></code>. <code><a class="el" href="structscran_1_1adt__quality__control_1_1MetricsBuffers.html#a541c0a789650dc135e5c759041c4a1c3">MetricsBuffers::subset_sum</a></code> is assumed to contain the sums of negative control feature subsets like IgG antibodies. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">block</td><td>Pointer to an array of length <code>num</code> containing block identifiers. Values should be integer IDs in <picture><source srcset="form_0_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$[0, N)$" src="form_0.png"/></picture> where <picture><source srcset="form_1_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$N$" src="form_1.png"/></picture> is the number of blocks. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">options</td><td>Further options for filtering. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
