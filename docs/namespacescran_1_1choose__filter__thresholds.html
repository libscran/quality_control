<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>scran_quality_control: scran::choose_filter_thresholds Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">scran_quality_control
   </div>
   <div id="projectbrief">Compute simple per-cell quality control metrics</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacescran.html">scran</a></li><li class="navelem"><a class="el" href="namespacescran_1_1choose__filter__thresholds.html">choose_filter_thresholds</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">scran::choose_filter_thresholds Namespace Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Define QC filter thresholds using a MAD-based approach.  
<a href="namespacescran_1_1choose__filter__thresholds.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structscran_1_1choose__filter__thresholds_1_1Options.html">Options</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="structscran_1_1choose__filter__thresholds_1_1Options.html" title="Options for compute().">Options</a> for <code><a class="el" href="namespacescran_1_1choose__filter__thresholds.html#ae991983721dc1e71443f6ae641f67205">compute()</a></code>.  <a href="structscran_1_1choose__filter__thresholds_1_1Options.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">Results</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html" title="Results of compute().">Results</a> of <code><a class="el" href="namespacescran_1_1choose__filter__thresholds.html#ae991983721dc1e71443f6ae641f67205">compute()</a></code>.  <a href="structscran_1_1choose__filter__thresholds_1_1Results.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ae991983721dc1e71443f6ae641f67205" id="r_ae991983721dc1e71443f6ae641f67205"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">typename</a> <a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">Float_</a> &gt; </td></tr>
<tr class="memitem:ae991983721dc1e71443f6ae641f67205"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">Results</a>&lt; <a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">Float_</a> &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacescran_1_1choose__filter__thresholds.html#ae991983721dc1e71443f6ae641f67205">compute</a> (<a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">const</a> <a class="el" href="structscran_1_1find__median__mad_1_1Results.html">find_median_mad::Results</a>&lt; <a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">Float_</a> &gt; &amp;<a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">mm</a>, <a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">const</a> <a class="el" href="structscran_1_1choose__filter__thresholds_1_1Options.html">Options</a> &amp;<a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">options</a>)</td></tr>
<tr class="separator:ae991983721dc1e71443f6ae641f67205"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56e2b8ed305d4f58b3a0e929db49afaa" id="r_a56e2b8ed305d4f58b3a0e929db49afaa"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">typename</a> <a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">Index_</a> , <a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">typename</a> <a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">Float_</a> &gt; </td></tr>
<tr class="memitem:a56e2b8ed305d4f58b3a0e929db49afaa"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">Results</a>&lt; <a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">Float_</a> &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacescran_1_1choose__filter__thresholds.html#a56e2b8ed305d4f58b3a0e929db49afaa">compute</a> (<a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">Index_</a> <a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">num</a>, <a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">Float_</a> *<a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">metrics</a>, <a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">const</a> <a class="el" href="structscran_1_1choose__filter__thresholds_1_1Options.html">Options</a> &amp;<a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">options</a>)</td></tr>
<tr class="separator:a56e2b8ed305d4f58b3a0e929db49afaa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae52b9902520938f7de10d808caabe2f4" id="r_ae52b9902520938f7de10d808caabe2f4"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">typename</a> <a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">Index_</a> , <a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">typename</a> <a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">Value_</a> , <a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">typename</a> <a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">Float_</a> &gt; </td></tr>
<tr class="memitem:ae52b9902520938f7de10d808caabe2f4"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">Results</a>&lt; <a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">Float_</a> &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacescran_1_1choose__filter__thresholds.html#ae52b9902520938f7de10d808caabe2f4">compute</a> (<a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">Index_</a> <a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">num</a>, <a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">const</a> <a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">Value_</a> *<a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">metrics</a>, <a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">Float_</a> *<a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">buffer</a>, <a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">const</a> <a class="el" href="structscran_1_1choose__filter__thresholds_1_1Options.html">Options</a> &amp;<a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">options</a>)</td></tr>
<tr class="separator:ae52b9902520938f7de10d808caabe2f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc92a1d34e7ca93a0dd82cdc156d6b12" id="r_adc92a1d34e7ca93a0dd82cdc156d6b12"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">typename</a> <a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">Float_</a> &gt; </td></tr>
<tr class="memitem:adc92a1d34e7ca93a0dd82cdc156d6b12"><td class="memTemplItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">Results</a>&lt; <a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">Float_</a> &gt; &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacescran_1_1choose__filter__thresholds.html#adc92a1d34e7ca93a0dd82cdc156d6b12">compute_blocked</a> (<a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">const</a> std::vector&lt; <a class="el" href="structscran_1_1find__median__mad_1_1Results.html">find_median_mad::Results</a>&lt; <a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">Float_</a> &gt; &gt; <a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">mms</a>, <a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">const</a> <a class="el" href="structscran_1_1choose__filter__thresholds_1_1Options.html">Options</a> &amp;<a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">options</a>)</td></tr>
<tr class="separator:adc92a1d34e7ca93a0dd82cdc156d6b12"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac23c9e27e19730fda2ca0d7d70339c1f" id="r_ac23c9e27e19730fda2ca0d7d70339c1f"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">typename</a> <a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">Index_</a> , <a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">typename</a> <a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">Value_</a> , <a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">typename</a> <a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">Block_</a> , <a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">typename</a> <a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">Float_</a> &gt; </td></tr>
<tr class="memitem:ac23c9e27e19730fda2ca0d7d70339c1f"><td class="memTemplItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">Results</a>&lt; <a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">Float_</a> &gt; &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacescran_1_1choose__filter__thresholds.html#ac23c9e27e19730fda2ca0d7d70339c1f">compute_blocked</a> (<a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">Index_</a> <a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">num</a>, <a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">const</a> <a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">Value_</a> *<a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">metrics</a>, <a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">const</a> <a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">Block_</a> *<a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">block</a>, <a class="el" href="classscran_1_1find__median__mad_1_1Workspace.html">find_median_mad::Workspace</a>&lt; <a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">Float_</a>, <a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">Index_</a> &gt; *<a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">workspace</a>, <a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">const</a> <a class="el" href="structscran_1_1choose__filter__thresholds_1_1Options.html">Options</a> &amp;<a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">options</a>)</td></tr>
<tr class="separator:ac23c9e27e19730fda2ca0d7d70339c1f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Define QC filter thresholds using a MAD-based approach. </p>
<p>We define filter thresholds on the QC metrics by assuming that most cells in the experiment are of high (or at least acceptable) quality. Any outlier values are indicative of low-quality cells that should be filtered out. Given an array of values, outliers are defined as those that are more than some number of median absolute deviations (MADs) from the median value. Outliers can be defined in both directions or just a single direction, depending on the interpretation of the QC metric.</p>
<p>For datasets with multiple blocks, we can also compute block-specific thresholds for each metric. This assumes that differences in the metric distributions between blocks are driven by uninteresting causes (e.g., differences in sequencing depth); variable thresholds can adapt to each block's distribution for effective removal of outliers. However, if the differences in the distributions between blocks are interesting, it may be preferable to ignore the blocking factor so that the MADs are correctly increased to reflect that variation. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="ae991983721dc1e71443f6ae641f67205" name="ae991983721dc1e71443f6ae641f67205"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae991983721dc1e71443f6ae641f67205">&#9670;&#160;</a></span>compute() <span class="overload">[1/3]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">typename</a> <a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">Float_</a> &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">Results</a>&lt; <a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">Float_</a> &gt; scran::choose_filter_thresholds::compute </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">const</a> <a class="el" href="structscran_1_1find__median__mad_1_1Results.html">find_median_mad::Results</a>&lt; <a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">Float_</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>mm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">const</a> <a class="el" href="structscran_1_1choose__filter__thresholds_1_1Options.html">Options</a> &amp;&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Float_</td><td>Floating-point type for the thresholds. </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mm</td><td>Median and MAD from <code><a class="el" href="namespacescran_1_1find__median__mad.html#a71c945f9e24df90abf065cc20e4067ae">find_median_mad::compute()</a></code>. If <code><a class="el" href="structscran_1_1choose__filter__thresholds_1_1Options.html#a61296fc2d9c9695879fb36bd63e1d49c">Options::log</a> = true</code>, it is expected that the median and MAD are computed on the log-transformed metrics (i.e., <code><a class="el" href="structscran_1_1find__median__mad_1_1Options.html#a1af43eeea4b45f4f6b7847affbbeefc5">find_median_mad::Options::log</a></code> was also set to true). </td></tr>
    <tr><td class="paramname">options</td><td>Further options. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The upper and lower thresholds derived from <code>mm</code>. </dd></dl>

</div>
</div>
<a id="a56e2b8ed305d4f58b3a0e929db49afaa" name="a56e2b8ed305d4f58b3a0e929db49afaa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a56e2b8ed305d4f58b3a0e929db49afaa">&#9670;&#160;</a></span>compute() <span class="overload">[2/3]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">typename</a> <a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">Index_</a> , <a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">typename</a> <a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">Float_</a> &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">Results</a>&lt; <a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">Float_</a> &gt; scran::choose_filter_thresholds::compute </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">Index_</a>&#160;</td>
          <td class="paramname"><em>num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">Float_</a> *&#160;</td>
          <td class="paramname"><em>metrics</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">const</a> <a class="el" href="structscran_1_1choose__filter__thresholds_1_1Options.html">Options</a> &amp;&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This overload computes the median and MAD via <code><a class="el" href="namespacescran_1_1find__median__mad.html#a71c945f9e24df90abf065cc20e4067ae">find_median_mad::compute()</a></code> before deriving thresholds with <code><a class="el" href="namespacescran_1_1choose__filter__thresholds.html#ae991983721dc1e71443f6ae641f67205">compute()</a></code>.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Index_</td><td>Integer type for the array indices. </td></tr>
    <tr><td class="paramname">Float_</td><td>Floating-point type for the metrics and thresholds.</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">num</td><td>Number of cells. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">metrics</td><td>Pointer to an array of length <code>num</code>, containing a QC metric for each cell. This is modified arbitrarily on output. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">options</td><td>Further options.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The upper and lower thresholds derived from <code>metrics</code>. </dd></dl>

</div>
</div>
<a id="ae52b9902520938f7de10d808caabe2f4" name="ae52b9902520938f7de10d808caabe2f4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae52b9902520938f7de10d808caabe2f4">&#9670;&#160;</a></span>compute() <span class="overload">[3/3]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">typename</a> <a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">Index_</a> , <a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">typename</a> <a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">Value_</a> , <a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">typename</a> <a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">Float_</a> &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">Results</a>&lt; <a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">Float_</a> &gt; scran::choose_filter_thresholds::compute </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">Index_</a>&#160;</td>
          <td class="paramname"><em>num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">const</a> <a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">Value_</a> *&#160;</td>
          <td class="paramname"><em>metrics</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">Float_</a> *&#160;</td>
          <td class="paramname"><em>buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">const</a> <a class="el" href="structscran_1_1choose__filter__thresholds_1_1Options.html">Options</a> &amp;&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This overload computes the median and MAD via <code><a class="el" href="namespacescran_1_1find__median__mad.html#a71c945f9e24df90abf065cc20e4067ae">find_median_mad::compute()</a></code> with automatic buffer allocation, before deriving thresholds with <code><a class="el" href="namespacescran_1_1choose__filter__thresholds.html#ae991983721dc1e71443f6ae641f67205">compute()</a></code>.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Index_</td><td>Integer type for the array indices. </td></tr>
    <tr><td class="paramname">Value_</td><td>Type for the input data. </td></tr>
    <tr><td class="paramname">Float_</td><td>Floating-point type for the metrics and thresholds.</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">num</td><td>Number of cells. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">metrics</td><td>Pointer to an array of length <code>num</code>, containing a QC metric for each cell. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">buffer</td><td>Pointer to an array of length <code>num</code> in which to store intermediate results. Alternatively NULL, in which case a buffer is automatically allocated. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">options</td><td>Further options.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The upper and lower thresholds derived from <code>metrics</code>. </dd></dl>

</div>
</div>
<a id="adc92a1d34e7ca93a0dd82cdc156d6b12" name="adc92a1d34e7ca93a0dd82cdc156d6b12"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adc92a1d34e7ca93a0dd82cdc156d6b12">&#9670;&#160;</a></span>compute_blocked() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">typename</a> <a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">Float_</a> &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; <a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">Results</a>&lt; <a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">Float_</a> &gt; &gt; scran::choose_filter_thresholds::compute_blocked </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">const</a> std::vector&lt; <a class="el" href="structscran_1_1find__median__mad_1_1Results.html">find_median_mad::Results</a>&lt; <a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">Float_</a> &gt; &gt;&#160;</td>
          <td class="paramname"><em>mms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">const</a> <a class="el" href="structscran_1_1choose__filter__thresholds_1_1Options.html">Options</a> &amp;&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Float_</td><td>Floating-point type for the thresholds. </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mms</td><td>Vector of medians and MADs for each block. </td></tr>
    <tr><td class="paramname">options</td><td>Further options.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A vector containing the upper and lower thresholds for each block. </dd></dl>

</div>
</div>
<a id="ac23c9e27e19730fda2ca0d7d70339c1f" name="ac23c9e27e19730fda2ca0d7d70339c1f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac23c9e27e19730fda2ca0d7d70339c1f">&#9670;&#160;</a></span>compute_blocked() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">typename</a> <a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">Index_</a> , <a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">typename</a> <a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">Value_</a> , <a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">typename</a> <a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">Block_</a> , <a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">typename</a> <a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">Float_</a> &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; <a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">Results</a>&lt; <a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">Float_</a> &gt; &gt; scran::choose_filter_thresholds::compute_blocked </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">Index_</a>&#160;</td>
          <td class="paramname"><em>num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">const</a> <a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">Value_</a> *&#160;</td>
          <td class="paramname"><em>metrics</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">const</a> <a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">Block_</a> *&#160;</td>
          <td class="paramname"><em>block</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classscran_1_1find__median__mad_1_1Workspace.html">find_median_mad::Workspace</a>&lt; <a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">Float_</a>, <a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">Index_</a> &gt; *&#160;</td>
          <td class="paramname"><em>workspace</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structscran_1_1choose__filter__thresholds_1_1Results.html">const</a> <a class="el" href="structscran_1_1choose__filter__thresholds_1_1Options.html">Options</a> &amp;&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This overload computes the median and MAD for each block via <code><a class="el" href="namespacescran_1_1find__median__mad.html#a31771db5590e3de43e2ffed92f03fc93">find_median_mad::compute_blocked()</a></code> before deriving thresholds in each block with <code><a class="el" href="namespacescran_1_1choose__filter__thresholds.html#adc92a1d34e7ca93a0dd82cdc156d6b12">compute_blocked()</a></code>.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Index_</td><td>Integer type for the array indices. </td></tr>
    <tr><td class="paramname">Value_</td><td>Type for the input data. </td></tr>
    <tr><td class="paramname">Float_</td><td>Floating-point type for the metrics and thresholds.</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">num</td><td>Number of cells. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">metrics</td><td>Pointer to an array of length <code>num</code>, containing a QC metric for each cell. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">block</td><td>Optional pointer to an array of block identifiers, see <code><a class="el" href="namespacescran_1_1find__median__mad.html#a31771db5590e3de43e2ffed92f03fc93">find_median_mad::compute_blocked()</a></code> for details. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">workspace</td><td>Pointer to a workspace object, see <code><a class="el" href="namespacescran_1_1find__median__mad.html#a31771db5590e3de43e2ffed92f03fc93">find_median_mad::compute_blocked()</a></code> for details. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">options</td><td>Further options.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A vector containing the upper and lower thresholds for each block. </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
