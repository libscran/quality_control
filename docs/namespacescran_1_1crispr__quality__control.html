<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>scran_quality_control: scran::crispr_quality_control Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">scran_quality_control
   </div>
   <div id="projectbrief">Compute simple per-cell quality control metrics</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacescran.html">scran</a></li><li class="navelem"><a class="el" href="namespacescran_1_1crispr__quality__control.html">crispr_quality_control</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">scran::crispr_quality_control Namespace Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Simple per-cell QC metrics from a CRISPR count matrix.  
<a href="namespacescran_1_1crispr__quality__control.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscran_1_1crispr__quality__control_1_1BlockedFilters.html">BlockedFilters</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Filter for high-quality cells using CRISPR-based metrics with blocking.  <a href="classscran_1_1crispr__quality__control_1_1BlockedFilters.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscran_1_1crispr__quality__control_1_1Filters.html">Filters</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Filter for high-quality cells using CRISPR-based metrics.  <a href="classscran_1_1crispr__quality__control_1_1Filters.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structscran_1_1crispr__quality__control_1_1FiltersOptions.html">FiltersOptions</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Options for <code>Filters()</code>.  <a href="structscran_1_1crispr__quality__control_1_1FiltersOptions.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structscran_1_1crispr__quality__control_1_1MetricsBuffers.html">MetricsBuffers</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Buffers for direct storage of the calculated statistics.  <a href="structscran_1_1crispr__quality__control_1_1MetricsBuffers.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structscran_1_1crispr__quality__control_1_1MetricsOptions.html">MetricsOptions</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Options for <code><a class="el" href="namespacescran_1_1crispr__quality__control.html#a5e0a41f185fd86479db5ef8a7e5d4116">compute_metrics()</a></code>.  <a href="structscran_1_1crispr__quality__control_1_1MetricsOptions.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structscran_1_1crispr__quality__control_1_1MetricsResults.html">MetricsResults</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Results of the QC metric calculations.  <a href="structscran_1_1crispr__quality__control_1_1MetricsResults.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a5e0a41f185fd86479db5ef8a7e5d4116" id="r_a5e0a41f185fd86479db5ef8a7e5d4116"><td class="memTemplParams" colspan="2">template&lt;typename Value_ , typename Index_ , typename Sum_ , typename Detected_ &gt; </td></tr>
<tr class="memitem:a5e0a41f185fd86479db5ef8a7e5d4116"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacescran_1_1crispr__quality__control.html#a5e0a41f185fd86479db5ef8a7e5d4116">compute_metrics</a> (const <a class="elRef" href="https://tatami-inc.github.io/tatami/classtatami_1_1Matrix.html">tatami::Matrix</a>&lt; Value_, Index_ &gt; *mat, <a class="el" href="structscran_1_1crispr__quality__control_1_1MetricsBuffers.html">MetricsBuffers</a>&lt; Sum_, Detected_, Value_, Index_ &gt; &amp;output, const <a class="el" href="structscran_1_1crispr__quality__control_1_1MetricsOptions.html">MetricsOptions</a> &amp;options)</td></tr>
<tr class="separator:a5e0a41f185fd86479db5ef8a7e5d4116"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5456326ad2cfe939762f0f79d2e9489b" id="r_a5456326ad2cfe939762f0f79d2e9489b"><td class="memTemplParams" colspan="2">template&lt;typename Sum_  = double, typename Detected_  = int, typename Value_  = double, typename Index_  = int&gt; </td></tr>
<tr class="memitem:a5456326ad2cfe939762f0f79d2e9489b"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="structscran_1_1crispr__quality__control_1_1MetricsResults.html">MetricsResults</a>&lt; Sum_, Detected_, Value_, Index_ &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacescran_1_1crispr__quality__control.html#a5456326ad2cfe939762f0f79d2e9489b">compute_metrics</a> (const <a class="elRef" href="https://tatami-inc.github.io/tatami/classtatami_1_1Matrix.html">tatami::Matrix</a>&lt; Value_, Index_ &gt; *mat, const <a class="el" href="structscran_1_1crispr__quality__control_1_1MetricsOptions.html">MetricsOptions</a> &amp;options)</td></tr>
<tr class="separator:a5456326ad2cfe939762f0f79d2e9489b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a376b9b86602e1beef8b58270ec616063" id="r_a376b9b86602e1beef8b58270ec616063"><td class="memTemplParams" colspan="2">template&lt;typename Float_  = double, typename Sum_  = double, typename Detected_  = int, typename Value_  = double, typename Index_  = int&gt; </td></tr>
<tr class="memitem:a376b9b86602e1beef8b58270ec616063"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="classscran_1_1crispr__quality__control_1_1Filters.html">Filters</a>&lt; Float_ &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacescran_1_1crispr__quality__control.html#a376b9b86602e1beef8b58270ec616063">compute_filters</a> (size_t num, const <a class="el" href="structscran_1_1crispr__quality__control_1_1MetricsBuffers.html">MetricsBuffers</a>&lt; Sum_, Detected_, Value_, Index_ &gt; &amp;metrics, const <a class="el" href="structscran_1_1crispr__quality__control_1_1FiltersOptions.html">FiltersOptions</a> &amp;options)</td></tr>
<tr class="separator:a376b9b86602e1beef8b58270ec616063"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc592b0d390ca248c7796ff4333d7aff" id="r_abc592b0d390ca248c7796ff4333d7aff"><td class="memTemplParams" colspan="2">template&lt;typename Float_  = double, typename Sum_  = double, typename Detected_  = int, typename Value_  = double, typename Index_  = int&gt; </td></tr>
<tr class="memitem:abc592b0d390ca248c7796ff4333d7aff"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="classscran_1_1crispr__quality__control_1_1Filters.html">Filters</a>&lt; Float_ &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacescran_1_1crispr__quality__control.html#abc592b0d390ca248c7796ff4333d7aff">compute_filters</a> (const <a class="el" href="structscran_1_1crispr__quality__control_1_1MetricsResults.html">MetricsResults</a>&lt; Sum_, Detected_, Value_, Index_ &gt; &amp;metrics, const <a class="el" href="structscran_1_1crispr__quality__control_1_1FiltersOptions.html">FiltersOptions</a> &amp;options)</td></tr>
<tr class="separator:abc592b0d390ca248c7796ff4333d7aff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c7e3955d25ac8111974ea44fea05ed9" id="r_a3c7e3955d25ac8111974ea44fea05ed9"><td class="memTemplParams" colspan="2">template&lt;typename Float_  = double, typename Sum_  = double, typename Detected_  = int, typename Value_  = double, typename Index_  = int, typename Block_  = int&gt; </td></tr>
<tr class="memitem:a3c7e3955d25ac8111974ea44fea05ed9"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="classscran_1_1crispr__quality__control_1_1BlockedFilters.html">BlockedFilters</a>&lt; Float_ &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacescran_1_1crispr__quality__control.html#a3c7e3955d25ac8111974ea44fea05ed9">compute_filters_blocked</a> (size_t num, const <a class="el" href="structscran_1_1crispr__quality__control_1_1MetricsBuffers.html">MetricsBuffers</a>&lt; Sum_, Detected_, Value_, Index_ &gt; &amp;metrics, const Block_ *block, const <a class="el" href="structscran_1_1crispr__quality__control_1_1FiltersOptions.html">FiltersOptions</a> &amp;options)</td></tr>
<tr class="separator:a3c7e3955d25ac8111974ea44fea05ed9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a41e3134f0f14330ec702ce2421e5a96b" id="r_a41e3134f0f14330ec702ce2421e5a96b"><td class="memTemplParams" colspan="2">template&lt;typename Float_  = double, typename Sum_  = double, typename Detected_  = int, typename Value_  = double, typename Index_  = int, typename Block_  = int&gt; </td></tr>
<tr class="memitem:a41e3134f0f14330ec702ce2421e5a96b"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="classscran_1_1crispr__quality__control_1_1BlockedFilters.html">BlockedFilters</a>&lt; Float_ &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacescran_1_1crispr__quality__control.html#a41e3134f0f14330ec702ce2421e5a96b">compute_filters_blocked</a> (const <a class="el" href="structscran_1_1crispr__quality__control_1_1MetricsResults.html">MetricsResults</a>&lt; Sum_, Detected_, Value_, Index_ &gt; &amp;metrics, const Block_ *block, const <a class="el" href="structscran_1_1crispr__quality__control_1_1FiltersOptions.html">FiltersOptions</a> &amp;options)</td></tr>
<tr class="separator:a41e3134f0f14330ec702ce2421e5a96b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Simple per-cell QC metrics from a CRISPR count matrix. </p>
<p>Given a feature-by-cell guide count matrix, this class computes several QC metrics:</p>
<ul>
<li>The sum of counts for each cell. Low counts indicate that the cell was not successfully transfected with a construct, or that library preparation and sequencing failed.</li>
<li>The number of detected guides per cell. In theory, this should be 1, as each cell should express no more than one guide construct. However, ambient contamination may introduce non-zero counts for multiple guides, without necessarily interfering with downstream analyses. As such, this metric is less useful for guide data, though we compute it anyway.</li>
<li>The maximum count in the most abundant guide construct. Low values indicate that the cell was not successfully transfected, or that library preparation and sequencing failed. The identity of the most abundant guide is also reported.</li>
</ul>
<p>Low-quality cells are defined as those with a low maximum count. Directly defining a threshold on the maximum count is somewhat tricky as unsuccessful transfection is not uncommon. This often results in a large subpopulation with low maximum counts, inflating the MAD and compromising the threshold calculation. Instead, we use the following approach:</p>
<ol type="1">
<li>Compute the median of the proportion of counts in the most abundant guide (i.e., the maximum proportion),</li>
<li>Subset the cells to only those with maximum proportions above the median,</li>
<li>Define a threshold for low outliers on the log-transformed maximum count within the subset.</li>
</ol>
<p>This assumes that over 50% of cells were successfully transfected with a single guide construct and have high maximum proportions. In contrast, unsuccessful transfections will be dominated by ambient contamination and have low proportions. By taking the subset above the median proportion, we remove all of the unsuccessful transfections and enrich for mostly-high-quality cells. From there, we can apply the usual outlier detection methods on the maximum count, with log-transformation to avoid a negative threshold.</p>
<p>Keep in mind that the maximum proportion is only used to define the subset for threshold calculation. Once the maximum count threshold is computed, they are applied to all cells, regardless of their maximum proportions. This allows us to recover good cells that would have been filtered out by our aggressive median subset. It also ensures that we do not remove cells transfected with multiple guides - such cells are not necessarily uninteresting, e.g., for examining interaction effects, so we will err on the side of caution and leave them in. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a5e0a41f185fd86479db5ef8a7e5d4116" name="a5e0a41f185fd86479db5ef8a7e5d4116"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5e0a41f185fd86479db5ef8a7e5d4116">&#9670;&#160;</a></span>compute_metrics() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Value_ , typename Index_ , typename Sum_ , typename Detected_ &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void scran::crispr_quality_control::compute_metrics </td>
          <td>(</td>
          <td class="paramtype">const <a class="elRef" href="https://tatami-inc.github.io/tatami/classtatami_1_1Matrix.html">tatami::Matrix</a>&lt; Value_, Index_ &gt; *&#160;</td>
          <td class="paramname"><em>mat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structscran_1_1crispr__quality__control_1_1MetricsBuffers.html">MetricsBuffers</a>&lt; Sum_, Detected_, Value_, Index_ &gt; &amp;&#160;</td>
          <td class="paramname"><em>output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structscran_1_1crispr__quality__control_1_1MetricsOptions.html">MetricsOptions</a> &amp;&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute the QC metrics from an input matrix. This is a wrapper around <code><a class="el" href="namespacescran_1_1per__cell__qc__metrics.html#a442874c635f37e35a72d7048246615e2">per_cell_qc_metrics::compute()</a></code> with some pre-configuration for CRISPR-relevant metrics.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Value_</td><td>Type of matrix value. </td></tr>
    <tr><td class="paramname">Index_</td><td>Type of the matrix indices. </td></tr>
    <tr><td class="paramname">Sum_</td><td>Numeric type to store the summed expression. </td></tr>
    <tr><td class="paramname">Detected_</td><td>Integer type to store the number of cells.</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">mat</td><td>Pointer to a feature-by-cells matrix containing counts. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">output</td><td><code><a class="el" href="structscran_1_1crispr__quality__control_1_1MetricsBuffers.html" title="Buffers for direct storage of the calculated statistics.">MetricsBuffers</a></code> object in which to store the output. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">options</td><td>Further options. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a5456326ad2cfe939762f0f79d2e9489b" name="a5456326ad2cfe939762f0f79d2e9489b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5456326ad2cfe939762f0f79d2e9489b">&#9670;&#160;</a></span>compute_metrics() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Sum_  = double, typename Detected_  = int, typename Value_  = double, typename Index_  = int&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structscran_1_1crispr__quality__control_1_1MetricsResults.html">MetricsResults</a>&lt; Sum_, Detected_, Value_, Index_ &gt; scran::crispr_quality_control::compute_metrics </td>
          <td>(</td>
          <td class="paramtype">const <a class="elRef" href="https://tatami-inc.github.io/tatami/classtatami_1_1Matrix.html">tatami::Matrix</a>&lt; Value_, Index_ &gt; *&#160;</td>
          <td class="paramname"><em>mat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structscran_1_1crispr__quality__control_1_1MetricsOptions.html">MetricsOptions</a> &amp;&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Overload of <code><a class="el" href="namespacescran_1_1crispr__quality__control.html#a5e0a41f185fd86479db5ef8a7e5d4116">compute_metrics()</a></code> that allocates memory for the results.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Sum_</td><td>Numeric type to store the summed expression. </td></tr>
    <tr><td class="paramname">Detected_</td><td>Integer type to store the number of cells. </td></tr>
    <tr><td class="paramname">Value_</td><td>Type of matrix value. </td></tr>
    <tr><td class="paramname">Index_</td><td>Type of the matrix indices. </td></tr>
    <tr><td class="paramname">Subset_</td><td>Either a pointer to an array of booleans or a <code>vector</code> of indices.</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">mat</td><td>Pointer to a feature-by-cells <b>tatami</b> matrix containing counts. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">subsets</td><td>Vector of feature subsets, see <code><a class="el" href="namespacescran_1_1per__cell__qc__metrics.html#a442874c635f37e35a72d7048246615e2">per_cell_qc_metrics::compute()</a></code> for details. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">options</td><td>Further options.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A <code>PerCellRnaQcMetrics::Results</code> object containing the QC metrics. Subset proportions are returned depending on the <code>subsets</code>. </dd></dl>

</div>
</div>
<a id="a376b9b86602e1beef8b58270ec616063" name="a376b9b86602e1beef8b58270ec616063"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a376b9b86602e1beef8b58270ec616063">&#9670;&#160;</a></span>compute_filters() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Float_  = double, typename Sum_  = double, typename Detected_  = int, typename Value_  = double, typename Index_  = int&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classscran_1_1crispr__quality__control_1_1Filters.html">Filters</a>&lt; Float_ &gt; scran::crispr_quality_control::compute_filters </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structscran_1_1crispr__quality__control_1_1MetricsBuffers.html">MetricsBuffers</a>&lt; Sum_, Detected_, Value_, Index_ &gt; &amp;&#160;</td>
          <td class="paramname"><em>metrics</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structscran_1_1crispr__quality__control_1_1FiltersOptions.html">FiltersOptions</a> &amp;&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Float_</td><td>Floating-point type for the thresholds. </td></tr>
    <tr><td class="paramname">Sum_</td><td>Numeric type to store the summed expression. </td></tr>
    <tr><td class="paramname">Detected_</td><td>Integer type to store the number of cells. </td></tr>
    <tr><td class="paramname">Value_</td><td>Type of matrix value. </td></tr>
    <tr><td class="paramname">Index_</td><td>Type of the matrix indices.</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">num</td><td>Number of cells. </td></tr>
    <tr><td class="paramname">metrics</td><td>A collection of arrays containing CRISPR-based QC metrics, filled by <code><a class="el" href="namespacescran_1_1crispr__quality__control.html#a5e0a41f185fd86479db5ef8a7e5d4116">compute_metrics()</a></code>. <code>MetricsBuffers::subset_sum</code> is assumed to contain the sums of negative control feature subsets like IgG antibodies. </td></tr>
    <tr><td class="paramname">options</td><td>Further options for filtering.</td></tr>
    <tr><td class="paramname"><a class="el" href="classscran_1_1crispr__quality__control_1_1Filters.html" title="Filter for high-quality cells using CRISPR-based metrics.">Filters</a></td><td>to be applied to CRISPR-based QC metrics. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="abc592b0d390ca248c7796ff4333d7aff" name="abc592b0d390ca248c7796ff4333d7aff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abc592b0d390ca248c7796ff4333d7aff">&#9670;&#160;</a></span>compute_filters() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Float_  = double, typename Sum_  = double, typename Detected_  = int, typename Value_  = double, typename Index_  = int&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classscran_1_1crispr__quality__control_1_1Filters.html">Filters</a>&lt; Float_ &gt; scran::crispr_quality_control::compute_filters </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structscran_1_1crispr__quality__control_1_1MetricsResults.html">MetricsResults</a>&lt; Sum_, Detected_, Value_, Index_ &gt; &amp;&#160;</td>
          <td class="paramname"><em>metrics</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structscran_1_1crispr__quality__control_1_1FiltersOptions.html">FiltersOptions</a> &amp;&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Float_</td><td>Floating-point type for the thresholds. </td></tr>
    <tr><td class="paramname">Sum_</td><td>Numeric type to store the summed expression. </td></tr>
    <tr><td class="paramname">Detected_</td><td>Integer type to store the number of cells. </td></tr>
    <tr><td class="paramname">Value_</td><td>Type of matrix value. </td></tr>
    <tr><td class="paramname">Index_</td><td>Type of the matrix indices.</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">metrics</td><td>CRISPR-based QC metrics from <code><a class="el" href="namespacescran_1_1crispr__quality__control.html#a5e0a41f185fd86479db5ef8a7e5d4116">compute_metrics()</a></code>. <code>MetricsBuffers::subset_sum</code> is assumed to contain the sums of negative control feature subsets like IgG antibodies. </td></tr>
    <tr><td class="paramname">options</td><td>Further options for filtering.</td></tr>
    <tr><td class="paramname"><a class="el" href="classscran_1_1crispr__quality__control_1_1Filters.html" title="Filter for high-quality cells using CRISPR-based metrics.">Filters</a></td><td>to be applied to CRISPR-based QC metrics. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a3c7e3955d25ac8111974ea44fea05ed9" name="a3c7e3955d25ac8111974ea44fea05ed9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c7e3955d25ac8111974ea44fea05ed9">&#9670;&#160;</a></span>compute_filters_blocked() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Float_  = double, typename Sum_  = double, typename Detected_  = int, typename Value_  = double, typename Index_  = int, typename Block_  = int&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classscran_1_1crispr__quality__control_1_1BlockedFilters.html">BlockedFilters</a>&lt; Float_ &gt; scran::crispr_quality_control::compute_filters_blocked </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structscran_1_1crispr__quality__control_1_1MetricsBuffers.html">MetricsBuffers</a>&lt; Sum_, Detected_, Value_, Index_ &gt; &amp;&#160;</td>
          <td class="paramname"><em>metrics</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Block_ *&#160;</td>
          <td class="paramname"><em>block</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structscran_1_1crispr__quality__control_1_1FiltersOptions.html">FiltersOptions</a> &amp;&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Sum_</td><td>Numeric type to store the summed expression. </td></tr>
    <tr><td class="paramname">Detected_</td><td>Integer type to store the number of cells. </td></tr>
    <tr><td class="paramname">Value_</td><td>Type of matrix value. </td></tr>
    <tr><td class="paramname">Index_</td><td>Type of the matrix indices. </td></tr>
    <tr><td class="paramname">Block_</td><td>Integer type for the block assignments.</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">num</td><td>Number of cells. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">metrics</td><td>A collection of arrays containing CRISPR-based QC metrics, filled by <code><a class="el" href="namespacescran_1_1crispr__quality__control.html#a5e0a41f185fd86479db5ef8a7e5d4116">compute_metrics()</a></code>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">block</td><td>Pointer to an array of length <code>num</code> containing block identifiers. Values should be integer IDs in <picture><source srcset="form_0_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$[0, N)$" src="form_0.png"/></picture> where <picture><source srcset="form_1_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$N$" src="form_1.png"/></picture> is the number of blocks. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">options</td><td>Further options for filtering.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="classscran_1_1crispr__quality__control_1_1Filters.html" title="Filter for high-quality cells using CRISPR-based metrics.">Filters</a> to be applied to blocks of CRISPR-based QC metrics. </dd></dl>

</div>
</div>
<a id="a41e3134f0f14330ec702ce2421e5a96b" name="a41e3134f0f14330ec702ce2421e5a96b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a41e3134f0f14330ec702ce2421e5a96b">&#9670;&#160;</a></span>compute_filters_blocked() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Float_  = double, typename Sum_  = double, typename Detected_  = int, typename Value_  = double, typename Index_  = int, typename Block_  = int&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classscran_1_1crispr__quality__control_1_1BlockedFilters.html">BlockedFilters</a>&lt; Float_ &gt; scran::crispr_quality_control::compute_filters_blocked </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structscran_1_1crispr__quality__control_1_1MetricsResults.html">MetricsResults</a>&lt; Sum_, Detected_, Value_, Index_ &gt; &amp;&#160;</td>
          <td class="paramname"><em>metrics</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Block_ *&#160;</td>
          <td class="paramname"><em>block</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structscran_1_1crispr__quality__control_1_1FiltersOptions.html">FiltersOptions</a> &amp;&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Sum_</td><td>Numeric type to store the summed expression. </td></tr>
    <tr><td class="paramname">Detected_</td><td>Integer type to store the number of cells. </td></tr>
    <tr><td class="paramname">Value_</td><td>Type of matrix value. </td></tr>
    <tr><td class="paramname">Index_</td><td>Type of the matrix indices. </td></tr>
    <tr><td class="paramname">Block_</td><td>Integer type for the block assignments.</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">metrics</td><td>CRISPR-based QC metrics computed by <code><a class="el" href="namespacescran_1_1crispr__quality__control.html#a5e0a41f185fd86479db5ef8a7e5d4116">compute_metrics()</a></code>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">block</td><td>Pointer to an array of length <code>num</code> containing block identifiers. Values should be integer IDs in <picture><source srcset="form_0_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$[0, N)$" src="form_0.png"/></picture> where <picture><source srcset="form_1_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$N$" src="form_1.png"/></picture> is the number of blocks. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">options</td><td>Further options for filtering.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="classscran_1_1crispr__quality__control_1_1Filters.html" title="Filter for high-quality cells using CRISPR-based metrics.">Filters</a> to be applied to blocks of CRISPR-based QC metrics. </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
