<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>scran_quality_control: scran::rna_quality_control Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">scran_quality_control
   </div>
   <div id="projectbrief">Compute simple per-cell quality control metrics</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacescran.html">scran</a></li><li class="navelem"><a class="el" href="namespacescran_1_1rna__quality__control.html">rna_quality_control</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">scran::rna_quality_control Namespace Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Simple per-cell QC metrics from an RNA count matrix.  
<a href="namespacescran_1_1rna__quality__control.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscran_1_1rna__quality__control_1_1BlockedFilters.html">BlockedFilters</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Filter for high-quality cells using RNA-based metrics with blocking.  <a href="classscran_1_1rna__quality__control_1_1BlockedFilters.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscran_1_1rna__quality__control_1_1Filters.html">Filters</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Filter for high-quality cells using RNA-based metrics.  <a href="classscran_1_1rna__quality__control_1_1Filters.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structscran_1_1rna__quality__control_1_1FiltersOptions.html">FiltersOptions</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Options for <code>Filters()</code>.  <a href="structscran_1_1rna__quality__control_1_1FiltersOptions.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structscran_1_1rna__quality__control_1_1MetricsBuffers.html">MetricsBuffers</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Buffers for direct storage of the calculated statistics.  <a href="structscran_1_1rna__quality__control_1_1MetricsBuffers.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structscran_1_1rna__quality__control_1_1MetricsOptions.html">MetricsOptions</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Options for <code><a class="el" href="namespacescran_1_1rna__quality__control.html#af46c0710c8d28bd27cae80f79d482ae1">compute_metrics()</a></code>.  <a href="structscran_1_1rna__quality__control_1_1MetricsOptions.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structscran_1_1rna__quality__control_1_1MetricsResults.html">MetricsResults</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Results of the QC metric calculations.  <a href="structscran_1_1rna__quality__control_1_1MetricsResults.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:af46c0710c8d28bd27cae80f79d482ae1" id="r_af46c0710c8d28bd27cae80f79d482ae1"><td class="memTemplParams" colspan="2">template&lt;typename Value_ , typename Index_ , typename Subset_ , typename Sum_ , typename Detected_ , typename Proportion_ &gt; </td></tr>
<tr class="memitem:af46c0710c8d28bd27cae80f79d482ae1"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacescran_1_1rna__quality__control.html#af46c0710c8d28bd27cae80f79d482ae1">compute_metrics</a> (const <a class="elRef" href="https://tatami-inc.github.io/tatami/classtatami_1_1Matrix.html">tatami::Matrix</a>&lt; Value_, Index_ &gt; *mat, const std::vector&lt; Subset_ &gt; &amp;subsets, <a class="el" href="structscran_1_1rna__quality__control_1_1MetricsBuffers.html">MetricsBuffers</a>&lt; Sum_, Detected_, Proportion_ &gt; &amp;output, const <a class="el" href="structscran_1_1rna__quality__control_1_1MetricsOptions.html">MetricsOptions</a> &amp;options)</td></tr>
<tr class="separator:af46c0710c8d28bd27cae80f79d482ae1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab533f23fa45aa86c93b4a32fc85be106" id="r_ab533f23fa45aa86c93b4a32fc85be106"><td class="memTemplParams" colspan="2">template&lt;typename Sum_  = double, typename Detected_  = int, typename Proportion_  = double, typename Value_  = double, typename Index_  = int, typename Subset_  = const uint8_t*&gt; </td></tr>
<tr class="memitem:ab533f23fa45aa86c93b4a32fc85be106"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="structscran_1_1rna__quality__control_1_1MetricsResults.html">MetricsResults</a>&lt; Sum_, Detected_, Proportion_ &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacescran_1_1rna__quality__control.html#ab533f23fa45aa86c93b4a32fc85be106">compute_metrics</a> (const <a class="elRef" href="https://tatami-inc.github.io/tatami/classtatami_1_1Matrix.html">tatami::Matrix</a>&lt; Value_, Index_ &gt; *mat, const std::vector&lt; Subset_ &gt; &amp;subsets, const <a class="el" href="structscran_1_1rna__quality__control_1_1MetricsOptions.html">MetricsOptions</a> &amp;options)</td></tr>
<tr class="separator:ab533f23fa45aa86c93b4a32fc85be106"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5167e6827b051b450cd7f381f46835ca" id="r_a5167e6827b051b450cd7f381f46835ca"><td class="memTemplParams" colspan="2">template&lt;typename Float_  = double, typename Sum_  = double, typename Detected_  = int, typename Proportion_  = double&gt; </td></tr>
<tr class="memitem:a5167e6827b051b450cd7f381f46835ca"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="classscran_1_1rna__quality__control_1_1Filters.html">Filters</a>&lt; Float_ &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacescran_1_1rna__quality__control.html#a5167e6827b051b450cd7f381f46835ca">compute_filters</a> (size_t num, const <a class="el" href="structscran_1_1rna__quality__control_1_1MetricsBuffers.html">MetricsBuffers</a>&lt; Sum_, Detected_, Proportion_ &gt; &amp;metrics, const <a class="el" href="structscran_1_1rna__quality__control_1_1FiltersOptions.html">FiltersOptions</a> &amp;options)</td></tr>
<tr class="separator:a5167e6827b051b450cd7f381f46835ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a160dc977011c3cf639e39568d0cca6aa" id="r_a160dc977011c3cf639e39568d0cca6aa"><td class="memTemplParams" colspan="2">template&lt;typename Float_  = double, typename Sum_  = double, typename Detected_  = int, typename Proportion_  = double&gt; </td></tr>
<tr class="memitem:a160dc977011c3cf639e39568d0cca6aa"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="classscran_1_1rna__quality__control_1_1Filters.html">Filters</a>&lt; Float_ &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacescran_1_1rna__quality__control.html#a160dc977011c3cf639e39568d0cca6aa">compute_filters</a> (const <a class="el" href="structscran_1_1rna__quality__control_1_1MetricsResults.html">MetricsResults</a>&lt; Sum_, Detected_, Proportion_ &gt; &amp;metrics, const <a class="el" href="structscran_1_1rna__quality__control_1_1FiltersOptions.html">FiltersOptions</a> &amp;options)</td></tr>
<tr class="separator:a160dc977011c3cf639e39568d0cca6aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd74c87f5984c6d4eb50d3370373ff13" id="r_acd74c87f5984c6d4eb50d3370373ff13"><td class="memTemplParams" colspan="2">template&lt;typename Float_  = double, typename Sum_  = double, typename Detected_  = int, typename Proportion_  = double, typename Block_  = int&gt; </td></tr>
<tr class="memitem:acd74c87f5984c6d4eb50d3370373ff13"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="classscran_1_1rna__quality__control_1_1BlockedFilters.html">BlockedFilters</a>&lt; Float_ &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacescran_1_1rna__quality__control.html#acd74c87f5984c6d4eb50d3370373ff13">compute_filters_blocked</a> (size_t num, const <a class="el" href="structscran_1_1rna__quality__control_1_1MetricsBuffers.html">MetricsBuffers</a>&lt; Sum_, Detected_, Proportion_ &gt; &amp;metrics, const Block_ *block, const <a class="el" href="structscran_1_1rna__quality__control_1_1FiltersOptions.html">FiltersOptions</a> &amp;options)</td></tr>
<tr class="separator:acd74c87f5984c6d4eb50d3370373ff13"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab59c03c5dd92fede69594411f0fc7b93" id="r_ab59c03c5dd92fede69594411f0fc7b93"><td class="memTemplParams" colspan="2">template&lt;typename Float_  = double, typename Sum_  = double, typename Detected_  = int, typename Proportion_  = double, typename Block_  = int&gt; </td></tr>
<tr class="memitem:ab59c03c5dd92fede69594411f0fc7b93"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="classscran_1_1rna__quality__control_1_1BlockedFilters.html">BlockedFilters</a>&lt; Float_ &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacescran_1_1rna__quality__control.html#ab59c03c5dd92fede69594411f0fc7b93">compute_filters_blocked</a> (const <a class="el" href="structscran_1_1rna__quality__control_1_1MetricsResults.html">MetricsResults</a>&lt; Sum_, Detected_, Proportion_ &gt; &amp;metrics, const Block_ *block, const <a class="el" href="structscran_1_1rna__quality__control_1_1FiltersOptions.html">FiltersOptions</a> &amp;options)</td></tr>
<tr class="separator:ab59c03c5dd92fede69594411f0fc7b93"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Simple per-cell QC metrics from an RNA count matrix. </p>
<p>Given a feature-by-cell RNA count matrix, we compute several metrics for filtering high-quality cells:</p>
<ul>
<li>The total sum of counts for each cell, which represents the efficiency of library preparation and sequencing. Low totals indicate that the library was not successfully captured.</li>
<li>The number of detected features. This also quantifies the library preparation efficiency, but with a greater focus on capturing the transcriptional complexity.</li>
<li>The proportion of counts in pre-defined feature subsets. The exact interpretation depends on the nature of the subset - most commonly, one subset will contain all genes on the mitochondrial chromosome, where higher proportions indicate cell damage due to loss of cytoplasmic transcripts. Spike-in proportions can be interpreted in a similar manner.</li>
</ul>
<p>Outliers are defined on each metric by counting the number of MADs from the median value across all cells, see <code><a class="el" href="namespacescran_1_1choose__filter__thresholds.html#ae991983721dc1e71443f6ae641f67205">choose_filter_thresholds::compute()</a></code> for details. For the total counts and number of detected features, the outliers are defined after log-transformation of the metrics. This improves resolution at low values and ensures that the defined threshold is not negative. Note that all thresholds are still reported on the original scale, so no further exponentiation is required. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="af46c0710c8d28bd27cae80f79d482ae1" name="af46c0710c8d28bd27cae80f79d482ae1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af46c0710c8d28bd27cae80f79d482ae1">&#9670;&#160;</a></span>compute_metrics() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Value_ , typename Index_ , typename Subset_ , typename Sum_ , typename Detected_ , typename Proportion_ &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void scran::rna_quality_control::compute_metrics </td>
          <td>(</td>
          <td class="paramtype">const <a class="elRef" href="https://tatami-inc.github.io/tatami/classtatami_1_1Matrix.html">tatami::Matrix</a>&lt; Value_, Index_ &gt; *&#160;</td>
          <td class="paramname"><em>mat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; Subset_ &gt; &amp;&#160;</td>
          <td class="paramname"><em>subsets</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structscran_1_1rna__quality__control_1_1MetricsBuffers.html">MetricsBuffers</a>&lt; Sum_, Detected_, Proportion_ &gt; &amp;&#160;</td>
          <td class="paramname"><em>output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structscran_1_1rna__quality__control_1_1MetricsOptions.html">MetricsOptions</a> &amp;&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute the QC metrics from an input matrix. This is a wrapper around <code><a class="el" href="namespacescran_1_1per__cell__qc__metrics.html#a442874c635f37e35a72d7048246615e2">per_cell_qc_metrics::compute()</a></code> with some pre-configuration for RNA-relevant metrics.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Value_</td><td>Type of matrix value. </td></tr>
    <tr><td class="paramname">Index_</td><td>Type of the matrix indices. </td></tr>
    <tr><td class="paramname">Subset_</td><td>Either a pointer to an array of booleans or a <code>vector</code> of indices. </td></tr>
    <tr><td class="paramname">Sum_</td><td>Numeric type to store the summed expression. </td></tr>
    <tr><td class="paramname">Detected_</td><td>Integer type to store the number of cells. </td></tr>
    <tr><td class="paramname">Proportion_</td><td>Floating-point type to store the proportions.</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">mat</td><td>Pointer to a feature-by-cells matrix containing counts. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">subsets</td><td>Vector of feature subsets, see <code><a class="el" href="namespacescran_1_1per__cell__qc__metrics.html#a442874c635f37e35a72d7048246615e2">per_cell_qc_metrics::compute()</a></code> for details. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">output</td><td><code><a class="el" href="structscran_1_1rna__quality__control_1_1MetricsBuffers.html" title="Buffers for direct storage of the calculated statistics.">MetricsBuffers</a></code> object in which to store the output. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">options</td><td>Further options. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ab533f23fa45aa86c93b4a32fc85be106" name="ab533f23fa45aa86c93b4a32fc85be106"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab533f23fa45aa86c93b4a32fc85be106">&#9670;&#160;</a></span>compute_metrics() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Sum_  = double, typename Detected_  = int, typename Proportion_  = double, typename Value_  = double, typename Index_  = int, typename Subset_  = const uint8_t*&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structscran_1_1rna__quality__control_1_1MetricsResults.html">MetricsResults</a>&lt; Sum_, Detected_, Proportion_ &gt; scran::rna_quality_control::compute_metrics </td>
          <td>(</td>
          <td class="paramtype">const <a class="elRef" href="https://tatami-inc.github.io/tatami/classtatami_1_1Matrix.html">tatami::Matrix</a>&lt; Value_, Index_ &gt; *&#160;</td>
          <td class="paramname"><em>mat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; Subset_ &gt; &amp;&#160;</td>
          <td class="paramname"><em>subsets</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structscran_1_1rna__quality__control_1_1MetricsOptions.html">MetricsOptions</a> &amp;&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Overload of <code><a class="el" href="namespacescran_1_1rna__quality__control.html#af46c0710c8d28bd27cae80f79d482ae1">compute_metrics()</a></code> that allocates memory for the results.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Sum_</td><td>Numeric type to store the summed expression. </td></tr>
    <tr><td class="paramname">Detected_</td><td>Integer type to store the number of cells. </td></tr>
    <tr><td class="paramname">Proportion_</td><td>Floating-point type to store the proportions. </td></tr>
    <tr><td class="paramname">Value_</td><td>Type of matrix value. </td></tr>
    <tr><td class="paramname">Index_</td><td>Type of the matrix indices. </td></tr>
    <tr><td class="paramname">Subset_</td><td>Either a pointer to an array of booleans or a <code>vector</code> of indices.</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">mat</td><td>Pointer to a feature-by-cells <b>tatami</b> matrix containing counts. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">subsets</td><td>Vector of feature subsets, see <code><a class="el" href="namespacescran_1_1per__cell__qc__metrics.html#a442874c635f37e35a72d7048246615e2">per_cell_qc_metrics::compute()</a></code> for details. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">options</td><td>Further options.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A <code>PerCellRnaQcMetrics::Results</code> object containing the QC metrics. Subset proportions are returned depending on the <code>subsets</code>. </dd></dl>

</div>
</div>
<a id="a5167e6827b051b450cd7f381f46835ca" name="a5167e6827b051b450cd7f381f46835ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5167e6827b051b450cd7f381f46835ca">&#9670;&#160;</a></span>compute_filters() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Float_  = double, typename Sum_  = double, typename Detected_  = int, typename Proportion_  = double&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classscran_1_1rna__quality__control_1_1Filters.html">Filters</a>&lt; Float_ &gt; scran::rna_quality_control::compute_filters </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structscran_1_1rna__quality__control_1_1MetricsBuffers.html">MetricsBuffers</a>&lt; Sum_, Detected_, Proportion_ &gt; &amp;&#160;</td>
          <td class="paramname"><em>metrics</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structscran_1_1rna__quality__control_1_1FiltersOptions.html">FiltersOptions</a> &amp;&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Float_</td><td>Floating-point type for the thresholds. </td></tr>
    <tr><td class="paramname">Sum_</td><td>Numeric type to store the summed expression. </td></tr>
    <tr><td class="paramname">Detected_</td><td>Integer type to store the number of cells. </td></tr>
    <tr><td class="paramname">Proportion_</td><td>Floating-point type to store the proportions. </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">num</td><td>Number of cells. </td></tr>
    <tr><td class="paramname">metrics</td><td>A collection of arrays containing RNA-based QC metrics, filled by <code><a class="el" href="namespacescran_1_1rna__quality__control.html#af46c0710c8d28bd27cae80f79d482ae1">compute_metrics()</a></code>. </td></tr>
    <tr><td class="paramname">options</td><td>Further options for filtering. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a160dc977011c3cf639e39568d0cca6aa" name="a160dc977011c3cf639e39568d0cca6aa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a160dc977011c3cf639e39568d0cca6aa">&#9670;&#160;</a></span>compute_filters() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Float_  = double, typename Sum_  = double, typename Detected_  = int, typename Proportion_  = double&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classscran_1_1rna__quality__control_1_1Filters.html">Filters</a>&lt; Float_ &gt; scran::rna_quality_control::compute_filters </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structscran_1_1rna__quality__control_1_1MetricsResults.html">MetricsResults</a>&lt; Sum_, Detected_, Proportion_ &gt; &amp;&#160;</td>
          <td class="paramname"><em>metrics</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structscran_1_1rna__quality__control_1_1FiltersOptions.html">FiltersOptions</a> &amp;&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Float_</td><td>Floating-point type for the thresholds. </td></tr>
    <tr><td class="paramname">Sum_</td><td>Numeric type to store the summed expression. </td></tr>
    <tr><td class="paramname">Detected_</td><td>Integer type to store the number of cells. </td></tr>
    <tr><td class="paramname">Proportion_</td><td>Floating-point type to store the proportions. </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">metrics</td><td>RNA-based QC metrics from <code><a class="el" href="namespacescran_1_1rna__quality__control.html#af46c0710c8d28bd27cae80f79d482ae1">compute_metrics()</a></code>. </td></tr>
    <tr><td class="paramname">options</td><td>Further options for filtering. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="acd74c87f5984c6d4eb50d3370373ff13" name="acd74c87f5984c6d4eb50d3370373ff13"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acd74c87f5984c6d4eb50d3370373ff13">&#9670;&#160;</a></span>compute_filters_blocked() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Float_  = double, typename Sum_  = double, typename Detected_  = int, typename Proportion_  = double, typename Block_  = int&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classscran_1_1rna__quality__control_1_1BlockedFilters.html">BlockedFilters</a>&lt; Float_ &gt; scran::rna_quality_control::compute_filters_blocked </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structscran_1_1rna__quality__control_1_1MetricsBuffers.html">MetricsBuffers</a>&lt; Sum_, Detected_, Proportion_ &gt; &amp;&#160;</td>
          <td class="paramname"><em>metrics</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Block_ *&#160;</td>
          <td class="paramname"><em>block</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structscran_1_1rna__quality__control_1_1FiltersOptions.html">FiltersOptions</a> &amp;&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Sum_</td><td>Numeric type to store the summed expression. </td></tr>
    <tr><td class="paramname">Detected_</td><td>Integer type to store the number of cells. </td></tr>
    <tr><td class="paramname">Proportion_</td><td>Floating-point type to store the proportions. </td></tr>
    <tr><td class="paramname">Block_</td><td>Integer type for the block assignments. </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">num</td><td>Number of cells. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">metrics</td><td>A collection of arrays containing RNA-based QC metrics, filled by <code><a class="el" href="namespacescran_1_1rna__quality__control.html#af46c0710c8d28bd27cae80f79d482ae1">compute_metrics()</a></code>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">block</td><td>Pointer to an array of length <code>num</code> containing block identifiers. Values should be integer IDs in <picture><source srcset="form_0_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$[0, N)$" src="form_0.png"/></picture> where <picture><source srcset="form_1_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$N$" src="form_1.png"/></picture> is the number of blocks. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">options</td><td>Further options for filtering. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ab59c03c5dd92fede69594411f0fc7b93" name="ab59c03c5dd92fede69594411f0fc7b93"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab59c03c5dd92fede69594411f0fc7b93">&#9670;&#160;</a></span>compute_filters_blocked() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Float_  = double, typename Sum_  = double, typename Detected_  = int, typename Proportion_  = double, typename Block_  = int&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classscran_1_1rna__quality__control_1_1BlockedFilters.html">BlockedFilters</a>&lt; Float_ &gt; scran::rna_quality_control::compute_filters_blocked </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structscran_1_1rna__quality__control_1_1MetricsResults.html">MetricsResults</a>&lt; Sum_, Detected_, Proportion_ &gt; &amp;&#160;</td>
          <td class="paramname"><em>metrics</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Block_ *&#160;</td>
          <td class="paramname"><em>block</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structscran_1_1rna__quality__control_1_1FiltersOptions.html">FiltersOptions</a> &amp;&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Sum_</td><td>Numeric type to store the summed expression. </td></tr>
    <tr><td class="paramname">Detected_</td><td>Integer type to store the number of cells. </td></tr>
    <tr><td class="paramname">Proportion_</td><td>Floating-point type to store the proportions. </td></tr>
    <tr><td class="paramname">Block_</td><td>Integer type for the block assignments. </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">metrics</td><td>RNA-based QC metrics computed by <code><a class="el" href="namespacescran_1_1rna__quality__control.html#af46c0710c8d28bd27cae80f79d482ae1">compute_metrics()</a></code>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">block</td><td>Pointer to an array of length <code>num</code> containing block identifiers. Values should be integer IDs in <picture><source srcset="form_0_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$[0, N)$" src="form_0.png"/></picture> where <picture><source srcset="form_1_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$N$" src="form_1.png"/></picture> is the number of blocks. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">options</td><td>Further options for filtering. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
